#!/bin/sh
################################################################################
# @brief    Script Help
################################################################################
_usage() {
cat <<-EOF
                "${0##*/}"
################################################################################

@Author:    Marco Israel
@Date:      2021-04
@Brief      Create an independent runable config folder at the new path.
@detail     This script clones (copies) the config folder to an abitary path and
            foldername given by the script input parameter and repaces the
            hardcoded pathes in the scripts by the new path. Afterwards it
            git checkout openssl_configs to revert changes in case the original
            configuration files were modified the someone before copy.

USAGE:
${0##*/}    <new_path>/<new_config_foldername>

@example
Create am independent openssl configuration bundle in the <path> with the given
foldername.
${0##*/}   ./<path>/<openssl_configs_copy_folder>

################################################################################
# END OF HELP.
EOF
}


# MAIN #########################################################################
if [ "$#" -eq 1 ]
then
    if [ ! -d "$1" ]
    then
        cp -r ./openssl_configs "$1"

        sed  -i "s/inputdir = openssl_configs/inputdir = ${1}/g"    \
            "$1"/root-ca-1.cnf

        sed  -i "s/inputdir = openssl_configs/inputdir = ${1}/g"    \
            "$1"/sub-ca-1.cnf

        git checkout openssl_configs
    fi

else
    _usage
fi


### EOF ########################################################################
