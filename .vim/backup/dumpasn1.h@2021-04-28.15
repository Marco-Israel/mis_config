#ifndef  DUMPASN1_H_
#define DUMPASN1_H_

#include <stdbool.h>

/* OID data sizes.  Because of Microsoft's "encode random noise and call it
   an OID" approach, we maintain two size limits, a sane one and one capable
   of holding the random-noise OID data, which we warn about */

#define MAX_OID_SIZE		40
#define MAX_SANE_OID_SIZE	32

/* Useful defines */

#ifndef TRUE
  #define FALSE	0
  #define TRUE	( !FALSE )
#endif /* TRUE */
#ifndef BYTE
  typedef unsigned char		BYTE;
#endif /* BYTE */

/* ASN.1 item chain to hold all ASN.1 items. */
#define MAX_VALUE_SIE   (512u)

/* Information on an ASN.1 Object Identifier */

typedef struct tagOIDINFO {
	struct tagOIDINFO *next;		/* Next item in list */
	BYTE oid[ MAX_OID_SIZE ];
	int oidLength;
	char *comment, *description;	/* Name, rank, serial number */
	int warn;						/* Whether to warn if OID encountered */
	} OIDINFO;

typedef struct data_offset_list{
    long offset;
    long length;
    long headerSize;
    long tag;
    OIDINFO * oidInfo;
    struct data_offset_list * nextptr;
    struct data_offset_list * prevptr;
  } DATA_OFFSET_LIST;

#include <stdio.h>
extern int dumpasn1( FILE* inFile, long  offset, int argc, char *argv[] );

extern int compareasn1( FILE * fileA, FILE * fileB, FILE * outputStream,
    _Bool verbose_output);
#endif /*DUMPASN1_H_ */



