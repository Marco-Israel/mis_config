# diff_tool.py

import argparse
import difflib
import sys

from pathlib import Path



def create_diff(golden, silver, string,  output_file: Path = None):

    golden_line = "\n"
    silver_line = "\n"

    with open (golden, "r") as f1:
        for line in f1:
            if string in line:
                golden_line = line.splitlines(True)
                break

    with open (silver, "r") as f2:
        for line in f2:
            if string in line:
                silver_line = line.splitlines(True)
                break

    delta = difflib.unified_diff(golden_line, silver_line,"golden", "silver")
    if output_file:
        with open(output_file, "w") as f:
            f.write(delta.__str__())
    else:
        sys.stdout.writelines(delta)




def main():
    parser = argparse.ArgumentParser()
    parser.add_argument("golden")
    parser.add_argument("silver")
    parser.add_argument("--output", help="the output file" )
    args = parser.parse_args()

    old_file = Path(args.golden)
    new_file = Path(args.silver)

    if args.output:
        output_file = Path(args.html)
    else:
        output_file = None

    create_diff(old_file, new_file, "diffme", output_file)


if __name__ == "__main__":
    main()

