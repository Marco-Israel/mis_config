TEST
3.2.2.1_Extension_BasicConstraints

--------------------------------------------------------------------------------
REQUIRED SCOPE:

1.
A CA certificate must include the basicConstraints name with the CA parameter
set to TRUE. An end-user certificate must either have CA:FALSE or omit the
extension entirely.

2.
The pathlen parameter specifies the maximum number of CAs
that can appear below this one in a chain. A pathlen of zero means the CA
cannot sign any sub-CA's, and can only sign end-entity certificates.


--------------------------------------------------------------------------------
TESTLIST:

1_root_pathlen_0_su_cert_CA_true
Define a root-ca configuration with pathlen of 0. Additional define a sub
end-user certificate configuration with CA parameter sets to TRUE


--------------------------------------------------------------------------------
1_root_pathlen_0_su_cert_CA_true

EXPACT:
openssl should NOT be able to generate a sub certificate because sub is not
  allowed to be a CA (defined by the parameter CA=TRUE) when root pathlen is 0.

Or in other word, according to man 5 x509v3_config:
"The pathlen parameter indicates the maximum number of CAs that can appear below
this one in a chain. So if you have a CA with a pathlen of zero it can only be
used to sign end user certificates and not further CAs."

RESULT:
FALSE
All certificates gets generated without any error notification by openssl.
Nether when CA=TRUE is set in ROOT certificate nor when it is set to CA=FALSE.

--------------------------------------------------------------------------------
2_sub_pathlen_99..99_and_CA_false

EXPACT:
all certificates will be generated

RESULT:
FALSE
The subscriber certificate generation fails because of the pathlen. A long or
short path length makes no different

--------------------------------------------------------------------------------
3_roo_pathlen_0_and_CA_TRUE

EXPACT:
Openssl shall neither be able to generate the sub nor the subscriber certificate

RESULT:
FALSE
The certificate chain breaks when generating the subscriber certificate

--------------------------------------------------------------------------------
4_root_pathlen_1_and_CA_true/

EXPACT:
The subscriber certificate shall not be generated because the path from root is
to short. Sub shall truly be generated

RESULT:
FALSE
All certificates are generated


--------------------------------------------------------------------------------
5_sub_pathlen_9_and_CA_true/

EXPACT:
All certificates will be generated

RESULT:
TRUE

--- EOF ------------------------------------------------------------------------

