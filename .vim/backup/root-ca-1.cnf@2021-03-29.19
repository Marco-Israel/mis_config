#
# Root CA
#
# Author: Matthias Nagel
# Date: 2021-03-12
#
.include ./cnf/oids.cnf
.include ./cnf/dn-name-policy.cnf

[ default ]
dir          = ./output
ca           = root_ca_1
openssl_conf = openssl_init

[ openssl_init ]
oid_section  = additional_oids

[ ca ]
default_ca   = root_ca_1

[ root_ca_1_dn ]
countryName             = "DE"
stateOrProvinceName     = "Somewhere"
localityName            = "Nowhere"
organizationName        = "My Company Ltd."
organizationalUnitName  = "My Department"
commonName              = "My Company Ltd., Root-CA (20210322175318)"

[ req ]   # This settings apply if the CA creates a loop-back CR for its own certificate
encrypt_key        = no
utf8               = yes
string_mask        = utf8only
name_opt           = multiline,-esc_msb,utf8,use_quote
req_opt            = ca_default
default_keyfile    = $dir/sks/root-ca-1-key.pem
distinguished_name = root_ca_1_dn
default_md         = sha384
prompt             = no                  # Attention: If yet to yes, the tool does not only ask for DN, but the meaning of the keywords in the section [ root_ca_1_dn ] changes, too.

[ attributes ]
SubjectPublicKeyInfo  =  ASN1:SEQUENCE:myAlgorithmIdentifier


# Operational settings for the Root CA
[ root_ca_1 ]
certs           = /dev/shm                          # Where the issued certs are kept
crl_dir         = $dir/crls                         # Where the issued crl are kept
database        = $dir/dbs/root-ca-1-index.txt      # database index file.
new_certs_dir   = /dev/shm                          # default place for new certs.
certificate     = $dir/tas/root-ca-1.pem            # The CA certificate
serial          = $dir/dbs/root-ca-1-serial.txt     # The current serial number
crlnumber       = $dir/dbs/root-ca-1-crlnumber.txt  # the current crl number
crl             = $dir/crls/root-ca-1.pem           # The current CRL
private_key     = $dir/sks/root-ca-1.pem            # The private key
unique_subject    = no                          # Allow multiple certs for same subject
preserve          = no                                 # keep passed DN ordering
policy            = dn_name_policy                     # Attention: This is not the CP
default_days      = 30                                 #
default_md        = sha384                             #
x509_extensions   = issued_extensions                  #
name_opt          = multiline,-esc_msb,utf8,use_quote  # Subject Name options
cert_opt          = ca_default                         # Certificate field options
copy_extensions   = copy                               # Copy extension from request, needed to copy the subjectAltName, in productive systems this is a security risk, because you might unintentionally copy unwanted extensions


# Defines the extensions that are added to the self-issued certificate
[ self_issued_extensions ]
basicConstraints       = critical,CA:TRUE
keyUsage               = critical,keyCertSign,cRLSign
certificatePolicies    = ed7DocsScipTlcp10
subjectKeyIdentifier   = hash
extendedKeyUsage       = ed7KpScipSCC
subjectDirectoryAttributes = ASN1:SEQUENCE:subject_dir_attributes


# Defines the extensions that are added to issued certificates, n.b. those are for the certificates of intermediate CAs
[ issued_extensions ]
basicConstraints       = critical, CA:TRUE
keyUsage               = critical,keyCertSign,cRLSign
certificatePolicies    = ed7DocsScipTlcp10
subjectKeyIdentifier   = hash
authorityKeyIdentifier = keyid:always
extendedKeyUsage       = ed7KpScipSCC
subjectDirectoryAttributes = ASN1:SEQUENCE:subject_dir_attributes


[ subject_dir_attributes ]
attribute1 = SEQUENCE:subject_clearance


[ subject_clearance ]
type = OID:clearanceAttribute
values = SET:subject_clearance_values


[ subject_clearance_values ]
value0 = SEQUENCE:subject_clearance_value_0


[ subject_clearance_value_0 ]
policyId = OID:ed7DocsScipTlcp10
classList = FORMAT:BITLIST,BITSTRING:1,2,3,4
securityCategories = SET:subject_clearance_value_0_security_categories


[ subject_clearance_value_0_security_categories ]
category0 = SEQUENCE:subject_clearance_value_0_information_domain


[ subject_clearance_value_0_information_domain ]
type = IMPLICIT:0,OID:ed7InformationDomain
value = EXPLICIT:1,PRINTABLESTRING:DE


[ myAlgorithmIdentifier ]


##### EOF ######################################################################
# vim:ft=sh
